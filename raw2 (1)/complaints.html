<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>All Complaints</title>
<link rel="stylesheet" href="index.css">
<style>
  body { font-family: Arial, sans-serif; margin: 0; padding: 20px; background: #f4f4f9; }
  h1 { 
    text-align: center; 
    color: #333; 
}
  #complaintsList { 
    max-width: 800px;
     margin: auto;
}
  .complaint {
     background: #fff;
     border: 1px solid #ddd; 
     padding: 15px; 
     margin-bottom: 15px; 
     border-radius: 8px; 
     box-shadow: 0 2px 4px rgba(0,0,0,0.1);
 }
  .complaint-header { 
    display: flex; 
    justify-content: space-between; 
    align-items: center; 
    border-bottom: 1px solid #eee; 
    padding-bottom: 10px; 
    margin-bottom: 15px;
}
  .complaint-header h3 { 
    margin: 0; 
    font-size: 1.2em; 
    color: #0056b3; 
}
  .status {
 padding: 5px 10px; 
 border-radius: 12px; 
 color: #fff;
  font-size: 0.8em; 
}
  .status-pending {
     background-color: #f39c12; 
    }
  .status-resolved { 
    background-color: #27ae60; 
}
  .status-inprogress { 
    background-color: #2980b9; 
}
  
  /* Details aligned line by line */
  .complaint-details {
    margin: 10px 0; 
}
  .detail-row { 
    display: flex;
     margin: 6px 0;
    }
  .detail-label { 
    width: 120px; 
    font-weight: bold; 
    color: #333;
 }
  .detail-value { 
    flex: 1; color: #555;
 }
  
  .complaint-footer { 
    margin-top: 15px; 
    padding-top: 10px; 
    border-top: 1px solid #eee; 
    font-size: 0.8em; 
    color: #777;
     text-align: right;
 }
  /* Your existing complaint styles stay here */
</style>
<script>
  const loggedInUser = JSON.parse(localStorage.getItem("citycare_loggedIn"));
  if (!loggedInUser || loggedInUser.role !== 'authority') {
      alert("Access Denied: You do not have permission to view this page.");
      window.location.href = "index.html";
  }
</script>
</head>
<body>
  <!-- Fixed Header -->
  <header class="site-header">
    <div class="logo">CityCare</div>
    <div class="nav-buttons">
      <a href="index.html"><button>Home</button></a>
      <a href="complaints.html"><button class="active">All Complaints</button></a>
      <a href="dashboard.html"><button>Dashboard</button></a>
      <a href="report.html"><button>Report Issue</button></a>
      <a href="auth.html"><button id="logoutBtn">Logout</button></a>
    </div>
  </header>

  <h1>All Submitted Complaints</h1>
  <div id="complaintsList">Loading...</div>

  <script>
  document.addEventListener("DOMContentLoaded", () => {
    const complaints = JSON.parse(localStorage.getItem("citycare_complaints_v1") || "[]");
    const container = document.getElementById("complaintsList");
    
    if(complaints.length === 0) {
      container.innerHTML = "<p>No complaints have been submitted yet.</p>";
      return;
    }
    
    container.innerHTML = complaints.map(c => `
      <div class="complaint">
        <div class="complaint-header">
          <h3>${c.title}</h3>
          <span class="status status-${c.status.toLowerCase()}">${c.status}</span>
        </div>
        <div class="complaint-details">
          <div class="detail-row"><div class="detail-label">Category:</div><div class="detail-value">${c.category}</div></div>
          <div class="detail-row"><div class="detail-label">Location:</div><div class="detail-value">${c.location}, ${c.constituency}</div></div>
          <div class="detail-row"><div class="detail-label">Description:</div><div class="detail-value">${c.desc}</div></div>
        </div>
        <div class="complaint-footer">
          Submitted by ${c.createdBy} on ${new Date(c.createdAt).toLocaleDateString()}
        </div>
      </div>
    `).join('');
  });
  </script>
</body>
</html>
